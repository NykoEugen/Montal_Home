{% load custom_admin_tags %}
{% with show_id=show_id|default:True %}
<div class="bg-white border border-beige-300 rounded-xl shadow-sm p-6 space-y-5 formset-card" data-formset-prefix="{{ formset.prefix }}">
    <div class="flex flex-col md:flex-row md:items-center md:justify-between gap-3">
        <div>
            <h2 class="text-xl font-semibold text-brown-900">{{ title }}</h2>
            {% if description %}
                <p class="text-sm text-brown-500">{{ description }}</p>
            {% endif %}
        </div>
        <div class="flex items-center gap-3">
            <span class="text-xs uppercase tracking-wide text-brown-400">
                <span class="formset-count" data-formset-prefix="{{ formset.prefix }}">{{ formset.total_form_count }}</span> записів
            </span>
            <button type="button" class="add-formset-item inline-flex items-center px-3 py-1.5 bg-brown-100 text-brown-700 rounded-md hover:bg-brown-200 transition" data-formset-prefix="{{ formset.prefix }}">
                <i class="fa-solid fa-plus mr-1"></i> Додати
            </button>
        </div>
    </div>
    {{ formset.management_form }}
    {% if formset.non_form_errors %}
        <div class="rounded-md bg-red-100 border border-red-300 px-3 py-2 text-sm text-red-700">
            {{ formset.non_form_errors }}
        </div>
    {% endif %}
    <div class="space-y-4 formset-items" data-formset-prefix="{{ formset.prefix }}">
        {% if formset.forms %}
            {% for subform in formset %}
                {% include "custom_admin/partials/formset_item.html" with form=subform formset=formset empty_label=empty_label image_preview=image_preview show_id=show_id %}
            {% endfor %}
        {% else %}
            <p class="text-sm text-brown-400 formset-empty-placeholder">Поки що немає записів.</p>
        {% endif %}
    </div>
    <template id="{{ formset.prefix }}-empty-form-template">
        {% include "custom_admin/partials/formset_item.html" with form=formset.empty_form formset=formset empty_label=empty_label image_preview=image_preview show_id=show_id %}
    </template>
</div>
{% endwith %}
